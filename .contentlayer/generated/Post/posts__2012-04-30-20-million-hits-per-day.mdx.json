{
  "title": "20.5 Million hits a day using an Amazon Micro server ($15 a month) and Node.js",
  "excerpt": "I have been building a website recently just to get current with the latest web technologies and scaling. I saw this post on Hacker News \"10 Million hits a day with WordPress using a $15 server\" and was intrigued.  It was time to benchmark one of my own applications!",
  "coverImage": "/assets/blog/img/icloud2.jpg",
  "date": "2012-07-01T00:00:00.000Z",
  "published": false,
  "author": {
    "name": "Dan Stroot",
    "picture": "/assets/blog/authors/dan.jpeg",
    "type": "Author",
    "_raw": {}
  },
  "ogImage": {
    "url": "/assets/blog/img/icloud2.jpg",
    "type": "OGImage",
    "_raw": {}
  },
  "seoURL": "https://danstroot.com/2012/06/30/20-million-hits-per-day/",
  "body": {
    "raw": "\nI have been building a website recently just to get current with the latest web technologies and scaling. I saw this post on Hacker News: [10 Million hits a day with WordPress using a $15 server](http://www.ewanleith.com/blog/900/10-million-hits-a-day-with-wordpress-using-a-15-server '10 Million hits a day with WordPress using a $15 server') and was intrigued. It was time to benchmark one of my own applications since it also runs on an Amazon Micro server for now as my development/production machine.\n\nFirst, let’s get this out of the way. Amazon will throttle your micro server into the ground if you actually ran this level of traffic for an extended period of time. This [article](http://gregsramblings.com/2011/02/07/amazon-ec2-micro-instance-cpu-steal/) explains it rather well. However this experiment still illustrates what is possible with this level of virtual hardware. If you actually have high levels of traffic then you already know a micro instance is not for you.\n\nI’m using an Amazon Linux x86 machine image (ami-31814f58) and the machine type is a “t1.micro” instance ($0.02 per hour – two cents an hour!). This is how Amazon describes a micro instance:\n\n- 613 MB memory\n- Up to 2 EC2 Compute Units (for short periodic bursts)\n- EBS storage only\n- 32-bit or 64-bit platform\n- I/O Performance: Low\n- API name: t1.micro\n\nI am using a 32 bit instance. I installed MySQL and compiled Node.js and then installed my web application – that’s it. Took me about an hour because I also installed phpMyAdmin and I hadn’t done it in a while.\n\nSome notes before we start testing – my Node.js application uses the Express framework and in the docs I noticed something interesting:\n\nTo alter the environment we can set the NODE_ENV environment variable, for example: `$ NODE_ENV=production node app.js`\n\nThis is very important, as many caching mechanisms are only enabled when in production.\n\nSo I set environment to production and we are ready to start testing. I am also using blitz.io and therefore had to do some housekeeping setting my application to serve their API key (clever since it prevents you from using blitz.io as a DoS tool). Once all that was done I was ready to run my first load test. I wasn’t really sure what to expect.\n\n### Let’s run a blitz.io “rush” to see how we’re doing\n\n[![Hit Rate](http://www.wanderingcio.com/wp-content/uploads/2012/04/15-1-300x140.png '15-1')](http://www.wanderingcio.com/wp-content/uploads/2012/04/15-1.png)\n\n_(click the image to see a full size version)_\n\nNote that blitz.io ramps up from 0 to 250 users, and our peak response rate was 238 hits per second as you can see above. This peak rate translates into **20,563,200 hits per day**!\n\nThroughout the test our response rates looked pretty stable and averaged 13ms for the duration of the test:\n\n[![Response Times](http://www.wanderingcio.com/wp-content/uploads/2012/04/15-2-300x139.png '15-2')](http://www.wanderingcio.com/wp-content/uploads/2012/04/15-2.png)\n\n_(click the image to see a full size version)_\n\nInterestingly blitz.io calculates your _average_ hit rate during the test and uses that to estimate hits per day rather than your peak rate. I’m not sure why they do it that way. Here is their summary:\n\n[![Summary](http://www.wanderingcio.com/wp-content/uploads/2012/04/15-3-300x44.png '15-3')](http://www.wanderingcio.com/wp-content/uploads/2012/04/15-3.png)\n\n_(click the image to see a full size version)_\n\nSo what did we learn here? That Node.js on an Amazon micro instance can run really well? Well yes I suppose, and this bodes well for true scalability to larger machines and to machine clusters in the future. But the real meat here is the confluence of several trends: ever more efficient web delivery (Nginx, Node.js, Varnish, etc.) , the move away from serving pages to serving data, and finally cloud infrastructure, means it is exceptionally easy to build highly scalable web sites for a very very small investment compared to several years ago.\n\nThis has profound implications for \"corporate IT\"!\n\n### References\n\n- [http://www.ewanleith.com/blog/900/10-million-hits-a-day-with-wordpress-using-a-15-server](http://www.ewanleith.com/blog/900/10-million-hits-a-day-with-wordpress-using-a-15-server)\n- [http://gregsramblings.com/2011/02/07/amazon-ec2-micro-instance-cpu-steal/](http://gregsramblings.com/2011/02/07/amazon-ec2-micro-instance-cpu-steal/)\n",
    "code": "var Component=(()=>{var d=Object.create;var r=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,w=Object.prototype.hasOwnProperty;var g=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),y=(n,e)=>{for(var i in e)r(n,i,{get:e[i],enumerable:!0})},s=(n,e,i,o)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let a of p(e))!w.call(n,a)&&a!==i&&r(n,a,{get:()=>e[a],enumerable:!(o=m(e,a))||o.enumerable});return n};var f=(n,e,i)=>(i=n!=null?d(u(n)):{},s(e||!n||!n.__esModule?r(i,\"default\",{value:n,enumerable:!0}):i,n)),b=n=>s(r({},\"__esModule\",{value:!0}),n);var c=g((k,l)=>{l.exports=_jsx_runtime});var j={};y(j,{default:()=>x,frontmatter:()=>v});var t=f(c()),v={title:\"20.5 Million hits a day using an Amazon Micro server ($15 a month) and Node.js\",excerpt:'I have been building a website recently just to get current with the latest web technologies and scaling. I saw this post on Hacker News \"10 Million hits a day with WordPress using a $15 server\" and was intrigued.  It was time to benchmark one of my own applications!',coverImage:\"/assets/blog/img/icloud2.jpg\",date:\"2012-07-01\",published:!1,author:{name:\"Dan Stroot\",picture:\"/assets/blog/authors/dan.jpeg\"},ogImage:{url:\"/assets/blog/img/icloud2.jpg\"},seoURL:\"https://danstroot.com/2012/06/30/20-million-hits-per-day/\"};function h(n){let e=Object.assign({p:\"p\",a:\"a\",ul:\"ul\",li:\"li\",code:\"code\",h3:\"h3\",img:\"img\",em:\"em\",strong:\"strong\"},n.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e.p,{children:[\"I have been building a website recently just to get current with the latest web technologies and scaling. I saw this post on Hacker News: \",(0,t.jsx)(e.a,{href:\"http://www.ewanleith.com/blog/900/10-million-hits-a-day-with-wordpress-using-a-15-server\",title:\"10 Million hits a day with WordPress using a $15 server\",children:\"10 Million hits a day with WordPress using a $15 server\"}),\" and was intrigued. It was time to benchmark one of my own applications since it also runs on an Amazon Micro server for now as my development/production machine.\"]}),`\n`,(0,t.jsxs)(e.p,{children:[\"First, let\\u2019s get this out of the way. Amazon will throttle your micro server into the ground if you actually ran this level of traffic for an extended period of time. This \",(0,t.jsx)(e.a,{href:\"http://gregsramblings.com/2011/02/07/amazon-ec2-micro-instance-cpu-steal/\",children:\"article\"}),\" explains it rather well. However this experiment still illustrates what is possible with this level of virtual hardware. If you actually have high levels of traffic then you already know a micro instance is not for you.\"]}),`\n`,(0,t.jsx)(e.p,{children:\"I\\u2019m using an Amazon Linux x86 machine image (ami-31814f58) and the machine type is a \\u201Ct1.micro\\u201D instance ($0.02 per hour \\u2013 two cents an hour!). This is how Amazon describes a micro instance:\"}),`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsx)(e.li,{children:\"613 MB memory\"}),`\n`,(0,t.jsx)(e.li,{children:\"Up to 2 EC2 Compute Units (for short periodic bursts)\"}),`\n`,(0,t.jsx)(e.li,{children:\"EBS storage only\"}),`\n`,(0,t.jsx)(e.li,{children:\"32-bit or 64-bit platform\"}),`\n`,(0,t.jsx)(e.li,{children:\"I/O Performance: Low\"}),`\n`,(0,t.jsx)(e.li,{children:\"API name: t1.micro\"}),`\n`]}),`\n`,(0,t.jsx)(e.p,{children:\"I am using a 32 bit instance. I installed MySQL and compiled Node.js and then installed my web application \\u2013 that\\u2019s it. Took me about an hour because I also installed phpMyAdmin and I hadn\\u2019t done it in a while.\"}),`\n`,(0,t.jsx)(e.p,{children:\"Some notes before we start testing \\u2013 my Node.js application uses the Express framework and in the docs I noticed something interesting:\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"To alter the environment we can set the NODE_ENV environment variable, for example: \",(0,t.jsx)(e.code,{children:\"$ NODE_ENV=production node app.js\"})]}),`\n`,(0,t.jsx)(e.p,{children:\"This is very important, as many caching mechanisms are only enabled when in production.\"}),`\n`,(0,t.jsx)(e.p,{children:\"So I set environment to production and we are ready to start testing. I am also using blitz.io and therefore had to do some housekeeping setting my application to serve their API key (clever since it prevents you from using blitz.io as a DoS tool). Once all that was done I was ready to run my first load test. I wasn\\u2019t really sure what to expect.\"}),`\n`,(0,t.jsx)(e.h3,{id:\"lets-run-a-blitzio-rush-to-see-how-were-doing\",children:\"Let\\u2019s run a blitz.io \\u201Crush\\u201D to see how we\\u2019re doing\"}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:\"http://www.wanderingcio.com/wp-content/uploads/2012/04/15-1.png\",children:(0,t.jsx)(e.img,{src:\"http://www.wanderingcio.com/wp-content/uploads/2012/04/15-1-300x140.png\",alt:\"Hit Rate\",title:\"15-1\"})})}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.em,{children:\"(click the image to see a full size version)\"})}),`\n`,(0,t.jsxs)(e.p,{children:[\"Note that blitz.io ramps up from 0 to 250 users, and our peak response rate was 238 hits per second as you can see above. This peak rate translates into \",(0,t.jsx)(e.strong,{children:\"20,563,200 hits per day\"}),\"!\"]}),`\n`,(0,t.jsx)(e.p,{children:\"Throughout the test our response rates looked pretty stable and averaged 13ms for the duration of the test:\"}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:\"http://www.wanderingcio.com/wp-content/uploads/2012/04/15-2.png\",children:(0,t.jsx)(e.img,{src:\"http://www.wanderingcio.com/wp-content/uploads/2012/04/15-2-300x139.png\",alt:\"Response Times\",title:\"15-2\"})})}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.em,{children:\"(click the image to see a full size version)\"})}),`\n`,(0,t.jsxs)(e.p,{children:[\"Interestingly blitz.io calculates your \",(0,t.jsx)(e.em,{children:\"average\"}),\" hit rate during the test and uses that to estimate hits per day rather than your peak rate. I\\u2019m not sure why they do it that way. Here is their summary:\"]}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.a,{href:\"http://www.wanderingcio.com/wp-content/uploads/2012/04/15-3.png\",children:(0,t.jsx)(e.img,{src:\"http://www.wanderingcio.com/wp-content/uploads/2012/04/15-3-300x44.png\",alt:\"Summary\",title:\"15-3\"})})}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.em,{children:\"(click the image to see a full size version)\"})}),`\n`,(0,t.jsx)(e.p,{children:\"So what did we learn here? That Node.js on an Amazon micro instance can run really well? Well yes I suppose, and this bodes well for true scalability to larger machines and to machine clusters in the future. But the real meat here is the confluence of several trends: ever more efficient web delivery (Nginx, Node.js, Varnish, etc.) , the move away from serving pages to serving data, and finally cloud infrastructure, means it is exceptionally easy to build highly scalable web sites for a very very small investment compared to several years ago.\"}),`\n`,(0,t.jsx)(e.p,{children:'This has profound implications for \"corporate IT\"!'}),`\n`,(0,t.jsx)(e.h3,{id:\"references\",children:\"References\"}),`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:\"http://www.ewanleith.com/blog/900/10-million-hits-a-day-with-wordpress-using-a-15-server\",children:\"http://www.ewanleith.com/blog/900/10-million-hits-a-day-with-wordpress-using-a-15-server\"})}),`\n`,(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:\"http://gregsramblings.com/2011/02/07/amazon-ec2-micro-instance-cpu-steal/\",children:\"http://gregsramblings.com/2011/02/07/amazon-ec2-micro-instance-cpu-steal/\"})}),`\n`]})]})}function I(n={}){let{wrapper:e}=n.components||{};return e?(0,t.jsx)(e,Object.assign({},n,{children:(0,t.jsx)(h,n)})):h(n)}var x=I;return b(j);})();\n;return Component;"
  },
  "_id": "posts/2012-04-30-20-million-hits-per-day.mdx",
  "_raw": {
    "sourceFilePath": "posts/2012-04-30-20-million-hits-per-day.mdx",
    "sourceFileName": "2012-04-30-20-million-hits-per-day.mdx",
    "sourceFileDir": "posts",
    "contentType": "mdx",
    "flattenedPath": "posts/2012-04-30-20-million-hits-per-day"
  },
  "type": "Post",
  "slug": "/posts/2012-04-30-20-million-hits-per-day",
  "slugAsParams": "2012-04-30-20-million-hits-per-day",
  "stats": {
    "text": "4 min read",
    "minutes": 3.05,
    "time": 183000,
    "words": 610
  }
}