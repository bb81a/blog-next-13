{
  "title": "Recursive Timeout",
  "summary": "Recursive timeout function that can be used for timed events.",
  "icon": "timer",
  "date": "2021-10-23T00:00:00.000Z",
  "published": true,
  "tags": [
    "React Hook"
  ],
  "body": {
    "raw": "\n<CodeBlock>\n\n```js:snippet.js\nimport { useState, useRef, useEffect, useCallback } from 'react';\n\nexport default function RecursiveTimeout(callback, delay) {\n  const [isRunning, setIsRunning] = useState(false);\n  const stop = useCallback(() => setIsRunning(false), [setIsRunning]);\n  const play = useCallback(() => setIsRunning(true), [setIsRunning]);\n  const savedCallback = useRef(callback);\n\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  useEffect(() => {\n    if (!isRunning) return;\n    let id = 0;\n\n    const tick = () => {\n      if (!isRunning) return clearTimeout(id);\n      savedCallback.current();\n      requestAnimationFrame(() => (id = setTimeout(tick, delay)));\n    };\n    requestAnimationFrame(() => (id = setTimeout(tick, delay)));\n\n    return () => {\n      if (id) clearTimeout(id);\n      stop();\n    };\n  }, [isRunning, delay, stop]);\n\n  return { play, stop };\n}\n```\n\n</CodeBlock>\n",
    "code": "var Component=(()=>{var o=Object.create;var c=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var N=(e,s)=>()=>(s||e((s={exports:{}}).exports,s),s.exports),f=(e,s)=>{for(var a in s)c(e,a,{get:s[a],enumerable:!0})},t=(e,s,a,i)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let l of u(s))!j.call(e,l)&&l!==a&&c(e,l,{get:()=>s[l],enumerable:!(i=m(s,l))||i.enumerable});return e};var k=(e,s,a)=>(a=e!=null?o(p(e)):{},t(s||!e||!e.__esModule?c(a,\"default\",{value:e,enumerable:!0}):a,e)),y=e=>t(c({},\"__esModule\",{value:!0}),e);var h=N((v,r)=>{r.exports=_jsx_runtime});var R={};f(R,{default:()=>w,frontmatter:()=>_});var n=k(h()),_={title:\"Recursive Timeout\",published:!0,date:\"2021-10-23\",summary:\"Recursive timeout function that can be used for timed events.\",icon:\"timer\",tags:[\"React Hook\"]};function d(e){let s=Object.assign({div:\"div\",pre:\"pre\",code:\"code\",span:\"span\"},e.components),{CodeBlock:a}=s;return a||g(\"CodeBlock\",!0),(0,n.jsxs)(a,{children:[(0,n.jsx)(s.div,{className:\"rehype-code-title\",children:\"snippet.js\"}),(0,n.jsx)(s.pre,{children:(0,n.jsxs)(s.code,{className:\"hljs language-js\",children:[(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"import\"}),\" { useState, useRef, useEffect, useCallback } \",(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"from\"}),\" \",(0,n.jsx)(s.span,{className:\"hljs-string\",children:\"'react'\"}),`;\n\n`,(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"export\"}),\" \",(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"default\"}),\" \",(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"function\"}),\" \",(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"RecursiveTimeout\"}),\"(\",(0,n.jsx)(s.span,{className:\"hljs-params\",children:\"callback, delay\"}),`) {\n  `,(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"const\"}),\" [isRunning, setIsRunning] = \",(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"useState\"}),\"(\",(0,n.jsx)(s.span,{className:\"hljs-literal\",children:\"false\"}),`);\n  `,(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"const\"}),\" stop = \",(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"useCallback\"}),\"(\",(0,n.jsx)(s.span,{className:\"hljs-function\",children:\"() =>\"}),\" \",(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"setIsRunning\"}),\"(\",(0,n.jsx)(s.span,{className:\"hljs-literal\",children:\"false\"}),`), [setIsRunning]);\n  `,(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"const\"}),\" play = \",(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"useCallback\"}),\"(\",(0,n.jsx)(s.span,{className:\"hljs-function\",children:\"() =>\"}),\" \",(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"setIsRunning\"}),\"(\",(0,n.jsx)(s.span,{className:\"hljs-literal\",children:\"true\"}),`), [setIsRunning]);\n  `,(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"const\"}),\" savedCallback = \",(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"useRef\"}),`(callback);\n\n  `,(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"useEffect\"}),\"(\",(0,n.jsx)(s.span,{className:\"hljs-function\",children:\"() =>\"}),` {\n    savedCallback.`,(0,n.jsx)(s.span,{className:\"hljs-property\",children:\"current\"}),` = callback;\n  }, [callback]);\n\n  `,(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"useEffect\"}),\"(\",(0,n.jsx)(s.span,{className:\"hljs-function\",children:\"() =>\"}),` {\n    `,(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"if\"}),\" (!isRunning) \",(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"return\"}),`;\n    `,(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"let\"}),\" id = \",(0,n.jsx)(s.span,{className:\"hljs-number\",children:\"0\"}),`;\n\n    `,(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"const\"}),\" \",(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"tick\"}),\" = (\",(0,n.jsx)(s.span,{className:\"hljs-params\"}),`) => {\n      `,(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"if\"}),\" (!isRunning) \",(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"return\"}),\" \",(0,n.jsx)(s.span,{className:\"hljs-built_in\",children:\"clearTimeout\"}),`(id);\n      savedCallback.`,(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"current\"}),`();\n      `,(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"requestAnimationFrame\"}),\"(\",(0,n.jsx)(s.span,{className:\"hljs-function\",children:\"() =>\"}),\" (id = \",(0,n.jsx)(s.span,{className:\"hljs-built_in\",children:\"setTimeout\"}),`(tick, delay)));\n    };\n    `,(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"requestAnimationFrame\"}),\"(\",(0,n.jsx)(s.span,{className:\"hljs-function\",children:\"() =>\"}),\" (id = \",(0,n.jsx)(s.span,{className:\"hljs-built_in\",children:\"setTimeout\"}),`(tick, delay)));\n\n    `,(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"return\"}),\" \",(0,n.jsx)(s.span,{className:\"hljs-function\",children:\"() =>\"}),` {\n      `,(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"if\"}),\" (id) \",(0,n.jsx)(s.span,{className:\"hljs-built_in\",children:\"clearTimeout\"}),`(id);\n      `,(0,n.jsx)(s.span,{className:\"hljs-title function_\",children:\"stop\"}),`();\n    };\n  }, [isRunning, delay, stop]);\n\n  `,(0,n.jsx)(s.span,{className:\"hljs-keyword\",children:\"return\"}),` { play, stop };\n}\n`]})})]})}function b(e={}){let{wrapper:s}=e.components||{};return s?(0,n.jsx)(s,Object.assign({},e,{children:(0,n.jsx)(d,e)})):d(e)}var w=b;function g(e,s){throw new Error(\"Expected \"+(s?\"component\":\"object\")+\" `\"+e+\"` to be defined: you likely forgot to import, pass, or provide it.\")}return y(R);})();\n;return Component;"
  },
  "_id": "snippets/recursive-timeout.mdx",
  "_raw": {
    "sourceFilePath": "snippets/recursive-timeout.mdx",
    "sourceFileName": "recursive-timeout.mdx",
    "sourceFileDir": "snippets",
    "contentType": "mdx",
    "flattenedPath": "snippets/recursive-timeout"
  },
  "type": "Snippet",
  "slug": "/snippets/recursive-timeout",
  "slugAsParams": "recursive-timeout",
  "stats": {
    "text": "1 min read",
    "minutes": 0.515,
    "time": 30900,
    "words": 103
  }
}